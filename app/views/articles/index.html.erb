
<h2>Results....</h2>

<%# This is chartkick stuff: %>
<%= line_chart Article.group_by_day(:created_at).count %>

<section class="cd-horizontal-timeline">
	<div class="timeline">
		<div class="events-wrapper">
			<div class="events">
				<ol>
        <!-- year-month-day -->
        <!-- day/month/year -->
        <% @index_timeline.each_with_index do |article, index| %>
          <%date = article.published_at%>

          <% date_format = date.strftime('%d/%m/%Y T %H:%M:%S')%> 

					<li><a href="#0" data-date="<%=date_format%>" class="<%='selected' if index == 0%>"><%=date_format%></a></li>
				</ol>
        <% end %>


				<span class="filling-line" aria-hidden="true"></span>
			</div> <!-- .events -->
		</div> <!-- .events-wrapper -->

		<ul class="cd-timeline-navigation">
			<li><a href="#0" class="prev inactive">Prev</a></li><!-- here -->
			<li><a href="#0" class="next">Next</a></li><!-- here -->
		</ul> <!-- .cd-timeline-navigation -->
	</div> <!-- .timeline -->

	<div class="events-content" style="min-height: 500px">
		<ol>
    <% @index_timeline.each_with_index do |article, index| %>
        <%date = article.published_at%>

        <% date_format = date.strftime('%d/%m/%Y T %H:%M:%S')%>  

        <li class="<%='selected' if index == 0%>" data-date="<%=date_format%>"><!-- here -->
          <div class="index-card">
          <p><%= article.published_at %> | <%= article.source %></p><!-- here -->
          <h4><%= article.title.truncate(65) %></h4>
          <p><%= article.description&.truncate(100) %></p><!-- here -->
        <div class="index-card-links">
        <%= link_to "See full article", article.article_url, target: :_blank, class: "btn btn-ireland" %>
        <button type="button" class="btn btn-ireland-outline" data-toggle="modal" data-target='#modal-article<%= article.id %>'>
          Save Article
        </button>
  <div class="modal fade" id='modal-article<%= article.id %>' tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">

    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Save Article to Timeline</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
        <h6>Save this article in a new Timeline</h6>
          <%= simple_form_for @timeline do |f| %>
            <%= f.input :topic, placeholder: 'Enter topic name', label: false %>
            <input name="saved_article_id" type="hidden" value="<%= article.id %>" />
            <%= f.button :submit, class: "btn btn-ireland mb-1" %>
          <% end %>
          <hr style="border-color: white">
        <h6>Add to an existing timeline</h6>
        <%= simple_form_for @saved_article do |f| %>
            <%= f.input :timeline, collection: @timelines.pluck(:topic), label: false %>
            <%= f.hidden_field :article_id, value: article.id %>
            <%= f.button :submit, "Add", class: "btn btn-ireland" %>
            <% end %>
        </div>

        <div class="modal-footer">
          <button type="button" class="btn btn-ireland-outline" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
  </div>

      </div>
			</li>
      <% end %>
		</ol>
	</div> <!-- .events-content -->
</section>



<%= javascript_pack_tag 'timeline' %>
